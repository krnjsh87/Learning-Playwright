# Day 23: GitHub Actions CI/CD & Cloud Testing with LambdaTest

**Date:** Day 23 of 25
**Duration:** 8 hours
**Difficulty:** Advanced
**Focus Area:** GitHub Actions, Cloud-Based Cross-Browser Testing, LambdaTest Integration, CI/CD Pipelines for Test Automation

---

## ðŸŽ¯ **Learning Objectives**

By the end of Day 23, you will:

âœ… Understand the fundamentals of GitHub Actions for CI/CD.
âœ… Create custom GitHub Actions workflows for running automated tests.
âœ… Integrate Playwright and Cypress tests into a GitHub Actions pipeline.
âœ… Understand the benefits of cloud-based testing platforms like LambdaTest.
âœ… Configure and run your test suites on LambdaTest's cloud grid.
âœ… Implement parallel test execution on the cloud to speed up feedback cycles.
âœ… Analyze test results and artifacts (videos, logs) from LambdaTest.
âœ… Use LambdaTest's advanced features for debugging and analytics.
âœ… Prepare for key concepts covered in the LambdaTest Playwright Certification.
âœ… Build a full-fledged CI/CD pipeline that runs tests on a cloud grid upon code changes.

---

## â° **Daily Schedule (8 Hours)**

| Time          | Activity                                                 | Duration |
|---------------|----------------------------------------------------------|----------|
| 8:00 - 8:30   | Review Day 22 & Introduction to GitHub Actions         | 30 min   |
| 8:30 - 10:30  | **Theory Session 1:** GitHub Actions Fundamentals        | 2 hours  |
| 10:30 - 11:00 | Break                                                    | 30 min   |
| 11:00 - 1:00 PM | **Hands-On Lab 1:** Building a CI Pipeline with GitHub Actions | 2 hours  |
| 1:00 - 2:00 PM  | Lunch Break                                              | 1 hour   |
| 2:00 - 4:00 PM  | **Theory Session 2:** Cloud Testing with LambdaTest    | 2 hours  |
| 4:00 - 4:30 PM  | Break                                                    | 30 min   |
| 4:30 - 6:30 PM  | **Hands-On Lab 2:** Integrating LambdaTest into the CI Pipeline | 2 hours  |

---

## ðŸ“š **THEORY SESSION 1: GitHub Actions Fundamentals (2 hours)**

### **Part 23.1: Introduction to GitHub Actions**

**What is GitHub Actions?**
GitHub Actions is a continuous integration and continuous delivery (CI/CD) platform that allows you to automate your build, test, and deployment pipeline. You can create workflows that build and test every pull request to your repository, or deploy merged pull requests to production.

**Core Components of GitHub Actions:**

*   **Workflow:** A configurable automated process that will run one or more jobs. Workflows are defined by a YAML file checked into your repository.
*   **Event:** A specific activity in a repository that triggers a workflow run. Examples: `push`, `pull_request`.
*   **Job:** A set of steps in a workflow that execute on the same runner.
*   **Step:** An individual task that can run commands in a job. A step can be either an **action** or a shell command.
*   **Action:** A reusable unit of code that can be combined into steps. You can use actions from the GitHub Marketplace or create your own.
*   **Runner:** A server that runs your workflows when they're triggered. GitHub provides Ubuntu Linux, Microsoft Windows, and macOS runners.

**Workflow File Example (`.github/workflows/ci.yml`):**
```yaml
name: End-to-End Tests
on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Use Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
      - run: npm ci
      - run: npm run test:e2e
```

### **Part 23.2: Creating a CI Workflow**

**1. Setting up the Workflow File:**
Create a directory named `.github/workflows` in your project root. Inside this directory, create a YAML file (e.g., `playwright-ci.yml`).

**2. Defining Triggers (`on`):**
The `on` keyword specifies the events that trigger the workflow.
```yaml
on:
  push:
    branches:
      - main
      - 'feature/**'
  pull_request:
    types: [opened, synchronize, reopened]
```

**3. Defining Jobs and Runners (`jobs`):**
A workflow must have at least one job. The `runs-on` keyword specifies the type of runner to use.
```yaml
jobs:
  playwright-tests:
    name: "Playwright E2E Tests"
    runs-on: ubuntu-latest
```

**4. Defining Steps (`steps`):**
Steps are the commands or actions that will be executed.
```yaml
steps:
  # 1. Check out the repository code
  - name: Checkout Code
    uses: actions/checkout@v3

  # 2. Set up the Node.js environment
  - name: Setup Node.js
    uses: actions/setup-node@v3
    with:
      node-version: 18

  # 3. Install project dependencies
  - name: Install Dependencies
    run: npm ci

  # 4. Install Playwright browsers
  - name: Install Playwright Browsers
    run: npx playwright install --with-deps

  # 5. Run the tests
  - name: Run Playwright Tests
    run: npx playwright test

  # 6. Upload test reports
  - name: Upload Test Report
    if: always()
    uses: actions/upload-artifact@v3
    with:
      name: playwright-report
      path: playwright-report/
      retention-days: 7
```

**Best Practices for GitHub Actions:**
*   **Use Specific Actions:** Use versioned actions (`actions/checkout@v3`) for stability.
*   **Cache Dependencies:** Use `actions/cache` to cache `node_modules` to speed up builds.
*   **Use Secrets for Sensitive Data:** Store API keys and passwords in GitHub Secrets (`secrets.LAMBDATEST_KEY`).
*   **Separate Jobs for Different Tasks:** Use separate jobs for linting, testing, and building to run them in parallel.
*   **Use `if: always()` for Cleanup/Reporting Steps:** Ensure reports are uploaded even if tests fail.

---

## ðŸ›  **HANDS-ON LAB 1: Building a CI Pipeline with GitHub Actions (2 hours)**

### **Objective**

Create a GitHub Actions workflow to automatically run your Playwright test suite whenever code is pushed to a pull request.

### **Step-by-Step Guide**

1.  **Navigate to your Project:** Open the Playwright project you've been working on.

2.  **Create the Workflow Directory:**
    ```bash
    mkdir -p .github/workflows
    ```

3.  **Create the Workflow File:**
    Create a new file: `.github/workflows/playwright-ci.yml`.

4.  **Add the Workflow Content:**
    Paste the following YAML into `playwright-ci.yml`.
    ```yaml
    name: Playwright Tests CI

    on:
      push:
        branches: [ main ]
      pull_request:
        branches: [ main ]

    jobs:
      test:
        name: 'Run Playwright Tests'
        runs-on: ubuntu-latest
        container:
          image: mcr.microsoft.com/playwright:v1.39.0-jammy # Use official Playwright image

        steps:
          - name: Checkout repository
            uses: actions/checkout@v3

          - name: Install dependencies
            run: npm ci

          - name: Run tests
            run: npx playwright test

          - name: Upload report
            if: always()
            uses: actions/upload-artifact@v3
            with:
              name: playwright-report
              path: playwright-report/
              retention-days: 5
    ```

5.  **Commit and Push:**
    Commit the new workflow file to your GitHub repository and create a pull request.

    ```bash
    git add .github/workflows/playwright-ci.yml
    git commit -m "feat: Add GitHub Actions CI workflow for Playwright"
    git push origin your-feature-branch
    ```

6.  **Observe the Workflow Run:**
    *   Go to your GitHub repository and open the pull request.
    *   Click on the **"Actions"** tab.
    *   You will see your workflow running. Click on it to see the logs for each step.
    *   Once the run is complete, you should see a green checkmark if all tests passed.
    *   Check the "Artifacts" section on the workflow summary page to download the `playwright-report`.

### **Mini-Assignment**

*   **Modify the workflow** to run tests on both `ubuntu-latest` and `windows-latest`.
*   **Add a step** to cache the `npm` dependencies using `actions/cache` to improve workflow speed.

---

## ðŸ“š **THEORY SESSION 2: Cloud Testing with LambdaTest (2 hours)**

### **Part 23.3: Why Cloud-Based Testing?**

Running tests locally or on a single CI runner has limitations:
*   **Limited Browser/OS Coverage:** You can only test on the browsers installed on the runner.
*   **Scalability Issues:** Running a large test suite serially is slow.
*   **Maintenance Overhead:** Maintaining a local grid of different browsers/OSes is complex.

**Cloud-based testing platforms** like LambdaTest provide an on-demand grid of thousands of real browsers, operating systems, and devices.

**Benefits:**
*   **Massive Parallelization:** Run hundreds of tests in parallel, reducing test execution time from hours to minutes.
*   **Comprehensive Coverage:** Test on 3000+ combinations of browsers, OS, and devices.
*   **Reduced Maintenance:** No need to manage your own test infrastructure.
*   **Rich Analytics:** Get access to video recordings, browser logs, network logs, and performance metrics for every test.
*   **Integrations:** Seamlessly integrates with CI/CD tools, project management tools, and more.

### **Part 23.4: Integrating LambdaTest with Playwright**

**1. Get LambdaTest Credentials:**
*   Sign up for a free LambdaTest account.
*   Go to your **Profile -> Account Settings -> Password & Security**.
*   Copy your **Username** and **Access Key**.

**2. Store Credentials as GitHub Secrets:**
*   In your GitHub repository, go to **Settings -> Secrets and variables -> Actions**.
*   Create two new repository secrets:
    *   `LT_USERNAME`: Your LambdaTest Username.
    *   `LT_ACCESS_KEY`: Your LambdaTest Access Key.

**3. Configure `playwright.config.ts` for LambdaTest:**
You need a special configuration file to tell Playwright how to connect to the LambdaTest grid.

Create a new config file, `playwright.lambdatest.config.ts`:
```typescript
import { PlaywrightTestConfig } from '@playwright/test';

const config: PlaywrightTestConfig = {
  testDir: './tests',
  timeout: 60000,
  retries: 1,
  use: {
    // Specify the browser you want to connect to.
    // This will be overridden by the capabilities below.
  },
  projects: [
    {
      name: 'chrome',
      use: {
        browserName: 'chromium',
      },
    },
    {
        name: "safari",
        use: {
            browserName: "webkit"
        }
    }
  ],
};

export default config;
```

**4. The `lambdatest-playwright.js` script:**
LambdaTest provides a script to wrap your test execution and send capabilities.
You will run your tests via the `lambdatest-playwright` CLI.

**5. Define Browser Capabilities:**
You define which browsers/OS combinations you want to test on.
These are passed as environment variables or in a config file.

---

## ðŸ›  **HANDS-ON LAB 2: Integrating LambdaTest into the CI Pipeline (2 hours)**

### **Objective**

Modify the GitHub Actions workflow to execute the Playwright test suite on the LambdaTest cloud grid across different browsers in parallel.

### **Step-by-Step Guide**

1.  **Install LambdaTest CLI:**
    In your project, install the LambdaTest CLI for Playwright.
    ```bash
    npm install -D @lambdatest/playwright-cli
    ```

2.  **Update `package.json` scripts:**
    Add a new script for running tests on LambdaTest.
    ```json
    "scripts": {
      "test:lambdatest": "lambdatest-playwright test"
    }
    ```

3.  **Create a `lambdatest.yml` config file:**
    In your project root, create `lambdatest.yml`. This file defines the browsers, OS, and other capabilities for your test run.
    ```yml
    run_settings:
      # Path to your playwright config file
      playwright_config_file: playwright.config.ts 
      # Number of parallel sessions
      parallels: 5 
      # Build name for the test run
      build_name: "Playwright GitHub Actions Build" 

# Browser capabilities
browser_settings:
  # Run tests on these browsers
  - browser: "Chrome"
    platform: "Windows 11"
    versions:
      - "latest"
  - browser: "Firefox"
    platform: "Windows 10"
    versions:
      - "latest"
  - browser: "Safari"
    platform: "macOS Sonoma"
    versions:
      - "latest"
  - browser: "Edge"
    platform: "Windows 11"
    versions:
      - "latest"

# Tunnel settings for testing localhost
tunnel_settings:
  tunnel: false
    ```

4.  **Modify the GitHub Actions Workflow (`playwright-ci.yml`):**
    Update your workflow to use the LambdaTest credentials and run the new script.
    ```yaml
    name: Playwright Tests CI on LambdaTest

    on:
      push:
        branches: [ main ]

    jobs:
      test:
        name: 'Run Playwright Tests on LambdaTest'
        runs-on: ubuntu-latest

        steps:
          - name: Checkout repository
            uses: actions/checkout@v3

          - name: Setup Node.js
            uses: actions/setup-node@v3
            with:
              node-version: 18

          - name: Install dependencies
            run: npm ci

          - name: Run Playwright tests on LambdaTest
            # Set LambdaTest credentials as environment variables
            env:
              LT_USERNAME: ${{ secrets.LT_USERNAME }}
              LT_ACCESS_KEY: ${{ secrets.LT_ACCESS_KEY }}
            run: npm run test:lambdatest
    ```

5.  **Commit and Push:**
    Commit the changes and push them to your repository.

6.  **Analyze Results on LambdaTest:**
    *   The GitHub Actions workflow will now trigger a build on LambdaTest.
    *   Go to your LambdaTest Dashboard -> Automation -> Builds.
    *   You will see your new build running.
    *   Click on the build to see the test sessions. Each session corresponds to a browser/OS combination.
    *   For each test, you can view:
        *   **Video recording** of the test execution.
        *   **Step-by-step screenshots.**
        *   **Browser console logs, network logs, and terminal logs.**
        *   **Test metadata and performance metrics.**

### **Quiz: GitHub Actions & LambdaTest**

1.  What is the purpose of the `on` key in a GitHub Actions workflow file?
    a) To define the runner OS.
    b) To specify the trigger events.
    c) To list the job steps.
    d) To set environment variables.

2.  What is a "runner" in the context of GitHub Actions?
    a) A reusable piece of code.
    b) A server that executes the workflow jobs.
    c) A workflow file.
    d) A trigger event.

3.  Why should you store sensitive data like `LT_ACCESS_KEY` in GitHub Secrets?
    a) To make them available in the logs.
    b) To avoid hardcoding them in your workflow files.
    c) To speed up the workflow.
    d) To share them with other users.

4.  What is the main benefit of using a cloud testing grid like LambdaTest for cross-browser testing?
    a) It's cheaper than running tests locally.
    b) It allows for massive parallelization and wide browser coverage without maintenance overhead.
    c) It makes tests run faster on a single machine.
    d) It only works with Playwright.

*(Answers: 1-b, 2-b, 3-b, 4-b)*
